<mvc:View
    controllerName="productsreport.controller.ListReport"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:form="sap.ui.layout.form"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    height="100%"
>
    <f:DynamicPage
        id="ListReport"
        headerExpanded="{/headerExpanded}"
        toggleHeaderOnTitleClick="{/titleClickable}"
    >
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="{i18n>productsTable}" />
                </f:heading>
            </f:DynamicPageTitle>
        </f:title>

        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <f:content>
                    <fb:FilterBar
                        useToolbar="false"
                        showClearOnFB="true"
                        showGoOnFB="false"
                    >
                        <fb:filterGroupItems>
                            <fb:FilterGroupItem
                                name="Name"
                                label="{i18n>productName}"
                                groupName="productFilter"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <SearchField width="90%" />
                                </fb:control>
                            </fb:FilterGroupItem>
                            <fb:FilterGroupItem
                                name="Category"
                                label="{i18n>category}"
                                groupName="productFilter"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <ComboBox
                                        width="90%"
                                        items="{data>/Categories}"
                                    >
                                        <core:Item
                                            key="{data>CategoryId}"
                                            text="{data>CategoryName}"
                                        />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>
                            <fb:FilterGroupItem
                                name="Producer"
                                label="{i18n>producer}"
                                groupName="productFilter"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <MultiInput
                                        id="multiInputWithValueHelp"
                                        suggestionItems="{path: 'data>/Producers', 
                                        sorter: {
                                        path:'ProducerName'}
                                        }"
                                        valueHelpRequest="handleValueHelp"
                                        tokenUpdate="onMultiInputTokenUpdate"
                                    >
                                        <core:Item
                                            key="{data>ProducerId}"
                                            text="{data>ProducerName}"
                                        />
                                    </MultiInput>
                                </fb:control>
                            </fb:FilterGroupItem>
                        </fb:filterGroupItems>
                    </fb:FilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox>
                <HBox
                    justifyContent="SpaceBetween"
                    alignItems="Center"
                    class="sapUiSmallMarginBottom"
                >
                    <Title
                        core:require="{Formatter: 'productsreport/utils/formatter'}"
                        text="{
                        parts: ['i18n>productsCount', 'data>/Products/length'],
                        formatter: 'Formatter.formatProductsCount'}"
                        level="H2"
                    />

                    <HBox>
                        <Button
                            text="{i18n>delete}"
                            enabled="false"
                        />
                        <Button
                            text="{i18n>create}"
                            class="sapUiTinyMarginBegin"
                        />
                    </HBox>
                </HBox>

                <Table
                    id="idProductsTable"
                    sticky="HeaderToolbar,ColumnHeaders"
                    mode="MultiSelect"
                    inset="false"
                    items="{
							path: 'data>/Products',
							sorter: {
								path: 'ProductName'
							}
						}"
                    class="sapFDynamicPageAlignContent"
                    width="auto"
                >
                    <columns>
                        <Column width="12em">
                            <Text text="{i18n>productName}" />
                        </Column>
                        <Column
                            minScreenWidth="Tablet"
                            demandPopin="true"
                        >
                            <Text text="{i18n>category}" />
                        </Column>
                        <Column
                            minScreenWidth="Tablet"
                            demandPopin="true"
                        >
                            <Text text="{i18n>producer}" />
                        </Column>
                        <Column hAlign="End">
                            <Text text="{i18n>quantity}" />
                        </Column>
                        <Column>
                            <Text text="{i18n>status}" />
                        </Column>
                    </columns>
                    <items>
                        <ColumnListItem
                            type="Navigation"
                            press=".onPressNavigateToDetails"
                        >
                            <cells>
                                <Text text="{data>ProductName}" />
                                <Text text="{data>Category}" />
                                <Text text="{data>ProducerName}" />
                                <Text text="{data>Quantity}" />
                                <ObjectStatus
                                    text="{= ${data>Quantity} > 100 ? ${i18n>tooMuch} : ${data>Quantity} > 20 ? ${i18n>good} : ${i18n>notEnough}}"
                                    state="{= ${data>Quantity} > 100 ? 'Error' :${data>Quantity} > 20 ? 'Success' : 'Warning'}"
                                />
                                <Button text=">" />
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>
